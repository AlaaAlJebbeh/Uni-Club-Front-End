<% if (!loggedIn) { %> <%- include("partials/header.ejs"); %> <% } else if (role
=== 'club') { %> <%- include("partials/club_header.ejs"); %> <% } else if (role
=== 'sks') { %> <%- include("partials/sks_header.ejs"); %> <% } %>

<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>UniClubs Home Page</title>
    <link rel="stylesheet" href="../public/styles/home.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
    />
    <script src="../public/scripts/home.js" defer></script>

    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body style="background-color: #dfecff">
    <% if (role === 'sks') { %>
    <div class="container">
      <div class="col-sm-12">
        <button
          style="
            float: right;
            width: 150px;
            height: 50px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: large;
            font-weight: bold;
            border-color: #000;
            color: #000;
            background-color: #193635;
          "
        >
          <a
            style="text-decoration: none; font-weight: 300; color: #fff"
            href="/createclub"
            >Create Club</a
          >
        </button>
      </div>
    </div>

    <% } %>

    <br /><br />
    <div class="container-fluid">
      <form style="margin-left: 75%" id="event-search-form">
        <input
          type="text"
          id="event-search-input"
          placeholder="Search by event name"
        />
        <button class="searchButton" type="submit">
          <span class="material-symbols-outlined"> search </span>
        </button>
      </form>
    </div>
  </br> 


    <br /><br /><br />
    <div class="container" style="padding: 25px; border-style: solid">
      <div class="col-sm-12">
        <h1 style="text-align: center; color: #000">Up Coming Events</h2>
      </div>
    </div>

    <div class="container">
      <div class="wrapper">
        <i id="left" class="fa-solid fa-angle-left"></i>
        <ul class="carousel">
          <% Events.forEach((event) => { %> <% const currentDate = new Date();
          currentDate.setHours(0, 0, 0, 0); const eventDate = new
          Date(event.date); eventDate.setHours(0, 0, 0, 0); if
          (currentDate.getTime() < eventDate.getTime()) { %>
          <li class="card">
            <div class="img">
              <div class="card">
                <div class="imgBx">
                  <img src="../public/images/<%=event.imageURL %>" alt="" />
                </div>
                <div class="contentBx">
                  <div class="content">
                    <% const currentDate = new Date(); currentDate.setHours(0,
                    0, 0, 0); const eventDate = new Date(event.date);
                    eventDate.setHours(0, 0, 0, 0); if (currentDate.getTime()
                    === eventDate.getTime()) { %>
                    <div class="statu-00">
                      <p>Active</p>
                    </div>
                    <% } else if (currentDate.getTime()> eventDate.getTime()) {
                    %>
                    <div class="statu-01"><p>Finished</p></div>
                    <% } else { %>
                    <div class="statu-02"><p>Soon</p></div>
                    <% } %>
                    <h2><%= event.club_name %></h2>
                    <br />
                    <h2 class="name"><%= event.event_name%></h2>
                    <br />
                    <h6>
                      Date:
                      <span><%= event.date.toString().substring(0, 11) %></span>
                    </h6>
                    <h6>Time: <span><%= event.time%></span></h6>
                    <h6>Location: <span><%= event.location%></span></h6>
                    <h6>Language: <span><%= event.language%></span></h6>
                    <h6>Guest: <span><%= event.guest%></span></h6>
                    <h6>Capacity: <span><%= event.capacity%></span></h6>
                    <h6>Notes: <span><%= event.notes%></span></h6>
                  </div>
                  <div class="overlay">
                    <h6>Description: <span><%= event.description%></span></h6>
                  </div>
                </div>
              </div>
            </div>
          </li>
          <% }%> <% }); %>
        </ul>
        <i id="right" class="fa-solid fa-angle-right"></i>
      </div>

      <div class="container-fluid" style="padding: 25px; border-style: solid">
        <div class="col-sm-12">
          <div class="row">
            <div class="col-sm-10">
              <h1 style="margin-left: 150px; margin-top:5px; color: #000">Events</h2>
            </div>
            <div class="col-sm-2">
              <div class="dropdown">
                <span
                  style="margin-left: 100px; color: #000; font-size: xxx-large"
                  type="button"
                  class="material-symbols-outlined"
                  data-bs-toggle="dropdown"
                >
                  filter_alt
                </span>
                <ul class="dropdown-menu">
                  <li class="dropdown-item" style="font-weight: bold">
                    Filter By Category:
                  </li>
                  <li class="dropdown-item" onclick="filterEvents('Fun')">
                    Fun
                  </li>
                  <li
                    class="dropdown-item"
                    onclick="filterEvents('Computer Science')"
                  >
                    Computer Science
                  </li>
                  <li
                    class="dropdown-item"
                    onclick="filterEvents('Psychology')"
                  >
                    Psychology
                  </li>
                  <li class="dropdown-item" onclick="filterEvents('Math')">
                    Math
                  </li>
                  <li class="dropdown-item" onclick="filterEvents('Language')">
                    Language
                  </li>
                  <li class="dropdown-item" onclick="filterEvents('Medicine')">
                    Medicine
                  </li>
                  <li class="dropdown-item" onclick="filterEvents('Chemistry')">
                    Chemistry
                  </li>
                  <li class="dropdown-item" onclick="filterEvents('all')">
                    All
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script>
        function filterEvents(category) {
          const allCards = document.querySelectorAll(".col-sm-6");
          allCards.forEach((card) => {
            const categorySpan = card.querySelector(
              ".content .category #categorySpan"
            );

            console.log(
              "Category Selected: " +
                category +
                " Category in card: " +
                categorySpan.textContent.trim()
            );

            const cardCategory = categorySpan.textContent.trim().toLowerCase();
            if (category === "all" || cardCategory === category.toLowerCase()) {
              card.style.display = "block"; // Show card
            } else {
              card.style.display = "none"; // Hide card
            }
          });
        }
      </script>

      <div class="col-sm-12">
        <div class="row">
          <% Events.forEach((event) => { %>
          <div class="col-sm-6">
            <div class="card">
              <div class="imgBx">
                <img src="../public/images/<%= event.imageURL %>" alt="" />
              </div>
              <div class="contentBx">
                <div class="content">
                  <% const currentDate = new Date(); currentDate.setHours(0, 0,
                  0, 0); const eventDate = new Date(event.date);
                  eventDate.setHours(0, 0, 0, 0); if (currentDate.getTime() ===
                  eventDate.getTime()) { %>
                  <div class="statu-00">
                    <p>Active</p>
                  </div>
                  <% } else if (currentDate.getTime()> eventDate.getTime()) { %>
                  <div class="statu-01"><p>Finished</p></div>
                  <% } else { %>
                  <div class="statu-02"><p>Soon</p></div>
                  <% } %>
                  <h2><%= event.club_name %></h2>
                  <br />
                  <h2 class="nameE"><%= event.event_name%></h2>
                  <br />
                  <h6>
                    Date:
                    <span><%= event.date.toString().substring(0, 11) %></span>
                  </h6>
                  <h6>Time: <span><%= event.time%></span></h6>
                  <h6>Location: <span><%= event.location%></span></h6>
                  <h6>Language: <span><%= event.language%></span></h6>
                  <h6>Guest: <span><%= event.guest_name%></span></h6>
                  <h6>
                    <div class="category">
                      Category:
                      <span id="categorySpan"><%= event.category %></span>
                    </div>
                  </h6>
                  <h6>Capacity: <span><%= event.capacity%></span></h6>
                  <h6>Notes: <span><%= event.notes%></span></h6>
                </div>
                <div class="overlay">
                  <h6>Description: <span><%= event.description %></span></h6>
                </div>
              </div>
            </div>
          </div>
          <% }); %>
        </div>
      </div>
    </div>
  </body>
  <footer><%- include("partials/footer.ejs") %></footer>
</html>
